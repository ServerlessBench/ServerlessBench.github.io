<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="configuration-load-process" />
	<meta name="description" content="configuration-load-process" />
	<!-- 网页标签标题 -->
	<title>configuration-load-process</title>
	<link rel="shortcut icon" href="/img/dubbo.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/en-us/index.html"><img class="logo" src="/img/dubbo_colorful.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">中</span><div class="header-menu"><img class="header-menu-toggle" src="/img/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a target="_self" href="/en-us/index.html">HOME</a></li><li class="menu-item menu-item-normal menu-item-normal-active"><a target="_self" href="/en-us/docs/user/quick-start.html">DOCS</a></li><li class="menu-item menu-item-normal"><a target="_self" href="/en-us/docs/developers/developers_dev.html">DEVELOPERS</a></li><li class="menu-item menu-item-normal"><a target="_self" href="/en-us/blog/download.html">DOWNLOAD</a></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/img/docs.png" class="front-img"/><span>Documentation</span><img src="/img/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>Document</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/user/preface/background.html" target="_self">Background</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/user/quick-start.html" target="_self">Quick start</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Configuration Loading Process</h1>
<p>This document focuses on <strong>how the Dubbo framework collects the required configuration</strong> (including application configuration, registry configuration, service configuration, etc.) <strong>during the application startup phase</strong> to complete the process of service exposure and reference.</p>
<p>Depending on how you drive it (such as Spring or naked API programming), the configuration form will certainly vary, for detail please refer to <a href="./xml.md">XML Configuration</a>, <a href="./annotation.md">Annotation Configuration</a> and <a href="./api.md">API Configuration</a>. In addition to the differences in peripheral drivers, Dubbo's configuration reads generally follow the following principles:</p>
<ol>
<li>Dubbo supports multiple levels of configuration and automatically override configurations according to predetermined priorities. Eventually, all configurations are aggregated to the data bus URL to drive subsequent service exposure, reference and other processes.</li>
<li>ApplicationConfig, ServiceConfig and ReferenceConfig can be regarded as configuration sources, which collect configuration by directly user-oriented programming.</li>
<li>The configuration format is mainly <code>Properties</code>, and the configuration content follows conventions</li>
<li>The configuration format is mainly Properties, and the configuration content follows the agreed <code>path-based</code> naming [specification](#Configuration Format).</li>
</ol>
<h2>Configuration Source</h2>
<p>First, starting with the configuration sources that Dubbo supports, there are four default configuration sources:</p>
<ul>
<li>JVM System Properties，-Dproperty</li>
<li>Externalized Configuration</li>
<li>ServiceConfig, ReferenceConfig and other programming interface collected configuration</li>
<li>Local configuration file dubbo.properties</li>
</ul>
<h3>Override Priority</h3>
<p>The figure below shows the priority of configuration override, decreasing from top to bottom:</p>
<p><img src="/img/blog/configuration.jpg" alt="Override Priority"></p>
<p>click here to view <a href="./config-center.md">Externalize configuration details</a></p>
<h2>Configuration Format</h2>
<p>Currently, all configurations supported by Dubbo are in the format of <code>.properties</code>, including <code>-D</code>, <code>Externalized Configuration</code>, etc., and all configuration items in <code>.properties</code> follow a <code>path-based</code> Configuration format:</p>
<pre><code class="language-properties"><span class="hljs-comment"># Application level</span>
<span class="hljs-meta">dubbo.{config-type}[.{config-id}].{config-item}</span>=<span class="hljs-string">{config-item-value}</span>
<span class="hljs-comment"># Service level</span>
<span class="hljs-meta">dubbo.service.{interface-name}[.{method-name}].{config-item}</span>=<span class="hljs-string">{config-item-value}</span>
<span class="hljs-meta">dubbo.reference.{interface-name}[.{method-name}].{config-item}</span>=<span class="hljs-string">{config-item-value}</span>
<span class="hljs-comment"># Multiple configuration items</span>
<span class="hljs-meta">dubbo.{config-type}s.{config-id}.{config-item}</span>=<span class="hljs-string">{config-item-value}</span>
</code></pre>
<ul>
<li>Application level</li>
</ul>
<pre><code class="language-properties"><span class="hljs-meta">dubbo.application.name</span>=<span class="hljs-string">demo-provider</span>
<span class="hljs-meta">dubbo.registry.address</span>=<span class="hljs-string">zookeeper://127.0.0.1:2181</span>
<span class="hljs-meta">dubbo.protocol.port</span>=<span class="hljs-string">-1</span>
</code></pre>
<ul>
<li>Service level</li>
</ul>
<pre><code class="language-properties"><span class="hljs-meta">dubbo.service.org.apache.dubbo.samples.api.DemoService.timeout</span>=<span class="hljs-string">5000</span>
<span class="hljs-meta">dubbo.reference.org.apache.dubbo.samples.api.DemoService.timeout</span>=<span class="hljs-string">6000</span>
<span class="hljs-meta">dubbo.reference.org.apache.dubbo.samples.api.DemoService.sayHello.timeout</span>=<span class="hljs-string">7000</span>
</code></pre>
<ul>
<li>Multiple configuration items</li>
</ul>
<pre><code class="language-properties"><span class="hljs-meta">dubbo.registries.unit1.address</span>=<span class="hljs-string">zookeeper://127.0.0.1:2181</span>
<span class="hljs-meta">dubbo.registries.unit2.address</span>=<span class="hljs-string">zookeeper://127.0.0.1:2182</span>

<span class="hljs-meta">dubbo.protocols.dubbo.name</span>=<span class="hljs-string">dubbo</span>
<span class="hljs-meta">dubbo.protocols.dubbo.port</span>=<span class="hljs-string">20880</span>
<span class="hljs-meta">dubbo.protocols.hessian.name</span>=<span class="hljs-string">hessian</span>
<span class="hljs-meta">dubbo.protocols.hessian.port</span>=<span class="hljs-string">8089</span>
</code></pre>
<ul>
<li>Extended configuration</li>
</ul>
<pre><code class="language-properties"><span class="hljs-meta">dubbo.application.parameters.item1</span>=<span class="hljs-string">value1</span>
<span class="hljs-meta">dubbo.application.parameters.item2</span>=<span class="hljs-string">value2</span>
<span class="hljs-meta">dubbo.registry.parameters.item3</span>=<span class="hljs-string">value3</span>
<span class="hljs-meta">dubbo.reference.org.apache.dubbo.samples.api.DemoService.parameters.item4</span>=<span class="hljs-string">value4</span>
</code></pre>
<h2>Several programming approaches of configuration</h2>
<p>Next, let's look at the changes corresponding to <code>ServiceConfig, ReferenceConfig and other programming interface collected configuration</code> when selecting different development methods.</p>
<h3>Spring</h3>
<ul>
<li>XML</li>
</ul>
<p>Refer to <a href="https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-basic">the sample</a></p>
<pre><code class="language-xml">  <span class="hljs-comment">&lt;!-- dubbo-provier.xml --&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:application</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"demo-provider"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:config-center</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"zookeeper://127.0.0.1:2181"</span>/&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:registry</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"zookeeper://127.0.0.1:2181"</span> <span class="hljs-attr">simplified</span>=<span class="hljs-string">"true"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:metadata-report</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"redis://127.0.0.1:6379"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:protocol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dubbo"</span> <span class="hljs-attr">port</span>=<span class="hljs-string">"20880"</span>/&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"demoService"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.dubbo.samples.basic.impl.DemoServiceImpl"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:service</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">"org.apache.dubbo.samples.basic.api.DemoService"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"demoService"</span>/&gt;</span>
</code></pre>
<ul>
<li>Annotation</li>
</ul>
<p>Refer to <a href="https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-annotation">the sample</a></p>
<pre><code class="language-java">  <span class="hljs-comment">// AnnotationService implementation</span>
  
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnnotationServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AnnotationService</span> </span>{
      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">sayHello</span><span class="hljs-params">(String name)</span> </span>{
          System.out.println(<span class="hljs-string">"async provider received: "</span> + name);
          <span class="hljs-keyword">return</span> <span class="hljs-string">"annotation: hello, "</span> + name;
      }
  }
</code></pre>
<pre><code class="language-properties"><span class="hljs-comment">  ## dubbo.properties</span>
  
  <span class="hljs-meta">dubbo.application.name</span>=<span class="hljs-string">annotation-provider</span>
  <span class="hljs-meta">dubbo.registry.address</span>=<span class="hljs-string">zookeeper://127.0.0.1:2181</span>
  <span class="hljs-meta">dubbo.protocol.name</span>=<span class="hljs-string">dubbo</span>
  <span class="hljs-meta">dubbo.protocol.port</span>=<span class="hljs-string">20880</span>
</code></pre>
<ul>
<li>Spring Boot</li>
</ul>
<p>Refer to <a href="https://github.com/apache/dubbo-spring-boot-project/tree/master/dubbo-spring-boot-samples">the sample</a></p>
<pre><code class="language-properties"><span class="hljs-comment">  ## application.properties</span>
<span class="hljs-comment">  
  # Spring boot application</span>
  <span class="hljs-meta">spring.application.name</span>=<span class="hljs-string">dubbo-externalized-configuration-provider-sample</span>
<span class="hljs-comment">  
  # Base packages to scan Dubbo Component: @com.alibaba.dubbo.config.annotation.Service</span>
  <span class="hljs-meta">dubbo.scan.base-packages</span>=<span class="hljs-string">com.alibaba.boot.dubbo.demo.provider.service</span>
<span class="hljs-comment">  
  # Dubbo Application</span>
<span class="hljs-comment">  ## The default value of dubbo.application.name is ${spring.application.name}</span>
<span class="hljs-comment">  ## dubbo.application.name=${spring.application.name}</span>
<span class="hljs-comment">  
  # Dubbo Protocol</span>
  <span class="hljs-meta">dubbo.protocol.name</span>=<span class="hljs-string">dubbo</span>
  <span class="hljs-meta">dubbo.protocol.port</span>=<span class="hljs-string">12345</span>
<span class="hljs-comment">  
  ## Dubbo Registry</span>
  <span class="hljs-meta">dubbo.registry.address</span>=<span class="hljs-string">N/A</span>
<span class="hljs-comment">  
  ## DemoService version</span>
  <span class="hljs-meta">demo.service.version</span>=<span class="hljs-string">1.0.0</span>
</code></pre>
<h3>API</h3>
<pre><code class="language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>{
    ServiceConfig&lt;GreetingsService&gt; service = <span class="hljs-keyword">new</span> ServiceConfig&lt;&gt;();
    service.setApplication(<span class="hljs-keyword">new</span> ApplicationConfig(<span class="hljs-string">"first-dubbo-provider"</span>));
    service.setRegistry(<span class="hljs-keyword">new</span> RegistryConfig(<span class="hljs-string">"multicast://224.5.6.7:1234"</span>));
    service.setInterface(GreetingsService<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;
    service.setRef(<span class="hljs-keyword">new</span> GreetingsServiceImpl());
    service.export();
    System.out.println(<span class="hljs-string">"first-dubbo-provider is running."</span>);
    System.in.read();
}
</code></pre>
<p>Refer to <a href="https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-api">the sample</a></p>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/img/dubbo_gray.png"/><img class="apache" src="/img/apache_logo.png"/><div class="cols-container"><div class="col col-12"><h3></h3><p></p></div><div class="col col-4"><dl><dt>Documentation</dt><dd><a href="/en-us/docs/user/quick-start.html" target="_self">Quick start</a></dd><dd><a href="/en-us/docs/dev/build.html" target="_self">Developer guide</a></dd><dd><a href="/en-us/docs/admin/ops/dubbo-ops.html" target="_self">Admin manual</a></dd><dd><a href="https://github.com/apache/dubbo-website/issues/new" target="_self">Report a Doc Issue</a></dd><dd><a href="https://github.com/apache/dubbo-website" target="_self">Edit This Page on GitHub</a></dd></dl></div></div><div class="copyright"><span>TODO Copyright © 2018-2019 The Apache Software Foundation. Apache and the Apache feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
  <script src="/build/documentation.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112489517-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-112489517-1');
	</script>
</body>
</html>